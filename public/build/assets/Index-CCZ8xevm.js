import{d as L,n as j,c as A,r as d,a as P,o as n,w as R,b as e,e as a,f as C,g as l,v as D,h as c,F as q,i as W,t as i,j as G,k as H,l as J,m as x,p as K,W as u}from"./app-0xfeTETD.js";import{_ as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-Czkn1H1y.js";import{_ as v}from"./InputError.vue_vue_type_script_setup_true_lang-CKZ2lRig.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BRkfCIi1.js";import"./index-1Zo7FGYr.js";const X={class:"p-8 min-h-screen bg-background text-foreground"},Y={class:"bg-card/90 backdrop-blur p-4 rounded-2xl border border-white/10 shadow-md shadow-[#190019]/20 mb-6 flex flex-wrap gap-4 items-end text-xs"},Z={class:"flex flex-col"},ee={class:"flex flex-col"},te={class:"flex flex-col"},oe={class:"flex flex-col"},se={class:"space-y-3"},re={class:"flex justify-between items-start mb-2"},ne={class:"flex items-center gap-2 mb-1"},le={class:"font-semibold text-sm"},ae={key:0,class:"px-2 py-0.5 rounded-full bg-yellow-500/20 text-yellow-200 text-[10px]"},de={class:"px-2 py-0.5 rounded-full bg-secondary/40 text-[10px] uppercase"},ie={class:"text-[11px] text-muted-foreground"},ue={key:0},pe={class:"flex flex-col gap-1 items-end"},ce=["onClick"],be={key:1,disabled:"",class:"px-2 py-1 rounded border border-border text-[11px] text-muted-foreground"},me={class:"flex gap-1 mt-1"},xe=["onClick"],ve=["onClick"],fe=["onClick"],ge=["onClick"],_e={class:"prose prose-sm max-w-none text-foreground/90"},ye={class:"whitespace-pre-wrap text-xs"},ke={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},we={class:"text-sm font-semibold mb-2"},Se={class:"flex flex-col gap-1"},Ce={class:"flex flex-col gap-1"},De={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},Ve={class:"flex flex-col gap-1"},Ae={class:"flex flex-col gap-1"},Te={class:"flex items-center gap-2 mt-5"},ze={class:"flex flex-col gap-1"},Ee={class:"flex justify-end gap-2 mt-3"},Be=L({__name:"Index",setup(Oe){const _=j(),T=[{title:"Dashboard",href:"/dashboard"},{title:"Actualizaciones",href:"/actualizaciones"}],z=A(()=>{const s=_.props.updates??[],t=new Map;return s.forEach(o=>{t.has(o.id)||t.set(o.id,o)}),Array.from(t.values())}),f=d(_.props.filters??{}),b=A(()=>_.props.errors??{}),y=d(f.value.estado??"activas"),k=d(f.value.audiencia??""),w=d(f.value.from??""),S=d(f.value.to??""),p=d(!1),m=d(null),r=d({titulo:"",cuerpo_md:"",audience:"TODOS",pinned:!1,starts_at:"",ends_at:""});function V(s){return s?s.substring(0,16):""}function E(){r.value={titulo:"",cuerpo_md:"",audience:"TODOS",pinned:!1,starts_at:"",ends_at:""}}function O(s){r.value={titulo:(s==null?void 0:s.titulo)??"",cuerpo_md:(s==null?void 0:s.cuerpo_md)??"",audience:(s==null?void 0:s.audience)??"TODOS",pinned:!!(s!=null&&s.pinned),starts_at:V(s==null?void 0:s.starts_at),ends_at:V(s==null?void 0:s.ends_at)}}function N(){u.get("/actualizaciones",{estado:y.value,audiencia:k.value||void 0,from:w.value||void 0,to:S.value||void 0},{preserveState:!0,preserveScroll:!0})}function $(){m.value=null,E(),p.value=!0}function U(s){m.value=s,O(s),p.value=!0}function h(){const s={titulo:r.value.titulo,cuerpo_md:r.value.cuerpo_md,audience:r.value.audience,pinned:r.value.pinned,starts_at:r.value.starts_at,ends_at:r.value.ends_at||null};m.value?u.put(`/actualizaciones/${m.value.id}`,s,{onSuccess:()=>p.value=!1,preserveScroll:!0}):u.post("/actualizaciones",s,{onSuccess:()=>p.value=!1,preserveScroll:!0})}function M(s){u.post(`/actualizaciones/${s}/read`,{},{preserveScroll:!0})}function B(s){u.post(`/actualizaciones/${s}/pin`,{},{preserveScroll:!0})}function F(s){u.post(`/actualizaciones/${s}/unpin`,{},{preserveScroll:!0})}function I(s){confirm("¿Eliminar esta actualización?")&&u.delete(`/actualizaciones/${s}`,{preserveScroll:!0})}return(s,t)=>(n(),P(Q,{breadcrumbs:T},{default:R(()=>[e("div",X,[e("h1",{class:"text-2xl font-bold mb-6 flex items-center justify-between"},[t[11]||(t[11]=e("span",null,"Actualizaciones",-1)),e("button",{type:"button",class:"px-3 py-2 rounded bg-primary text-primary-foreground text-xs hover:opacity-90",onClick:$}," + Nueva actualización ")]),e("div",Y,[e("div",Z,[t[13]||(t[13]=e("label",{class:"text-[11px] text-muted-foreground mb-1"},"Estado",-1)),l(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>y.value=o),class:"border border-border bg-background text-foreground p-2 rounded min-w-[140px]"},t[12]||(t[12]=[e("option",{value:"activas"},"Activas",-1),e("option",{value:"proximas"},"Próximas",-1),e("option",{value:"vencidas"},"Vencidas",-1),e("option",{value:"todas"},"Todas",-1)]),512),[[D,y.value]])]),e("div",ee,[t[15]||(t[15]=e("label",{class:"text-[11px] text-muted-foreground mb-1"},"Audiencia",-1)),l(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>k.value=o),class:"border border-border bg-background text-foreground p-2 rounded min-w-[140px]"},t[14]||(t[14]=[e("option",{value:""},"Todas",-1),e("option",{value:"TODOS"},"Todos",-1),e("option",{value:"DOCENTES"},"Docentes",-1),e("option",{value:"RESPONSABLES"},"Responsables",-1),e("option",{value:"ADMIN"},"Admin",-1)]),512),[[D,k.value]])]),e("div",te,[t[16]||(t[16]=e("label",{class:"text-[11px] text-muted-foreground mb-1"},"Desde",-1)),l(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>w.value=o),type:"date",class:"border border-border bg-background text-foreground p-2 rounded min-w-[140px]"},null,512),[[c,w.value]])]),e("div",oe,[t[17]||(t[17]=e("label",{class:"text-[11px] text-muted-foreground mb-1"},"Hasta",-1)),l(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>S.value=o),type:"date",class:"border border-border bg-background text-foreground p-2 rounded min-w-[140px]"},null,512),[[c,S.value]])]),e("button",{type:"button",class:"px-4 py-2 rounded bg-primary text-primary-foreground hover:opacity-90",onClick:N}," Aplicar filtros ")]),e("div",se,[(n(!0),a(q,null,W(z.value,o=>(n(),a("div",{key:o.id,class:"bg-card/90 backdrop-blur rounded-2xl border border-white/10 shadow-md shadow-[#190019]/20 p-4 text-xs"},[e("div",re,[e("div",null,[e("div",ne,[e("h2",le,i(o.titulo),1),o.pinned?(n(),a("span",ae,"PIN")):C("",!0),e("span",de,i(o.audience),1),e("span",{class:G(["px-2 py-0.5 rounded-full text-[10px]",o.is_active?"bg-green-500/20 text-green-200":"bg-muted text-muted-foreground"])},i(o.is_active?"ACTIVA":"NO ACTIVA"),3)]),e("div",ie,[H(" Vigencia: "+i(o.starts_at?new Date(o.starts_at).toLocaleString():"—")+" ",1),o.ends_at?(n(),a("span",ue," → "+i(new Date(o.ends_at).toLocaleString()),1)):C("",!0)])]),e("div",pe,[o.leido?(n(),a("button",be," Leído ")):(n(),a("button",{key:0,class:"px-2 py-1 rounded bg-primary text-primary-foreground text-[11px]",onClick:g=>M(o.id)}," Marcar leído ",8,ce)),e("div",me,[e("button",{class:"px-2 py-1 rounded border border-border text-[11px]",onClick:g=>U(o)}," Editar ",8,xe),e("button",{class:"px-2 py-1 rounded border border-border text-[11px]",onClick:g=>I(o.id)}," Eliminar ",8,ve),o.pinned?(n(),a("button",{key:1,class:"px-2 py-1 rounded border border-border text-[11px]",onClick:g=>F(o.id)}," Unpin ",8,ge)):(n(),a("button",{key:0,class:"px-2 py-1 rounded border border-border text-[11px]",onClick:g=>B(o.id)}," Pin ",8,fe))])])]),e("div",_e,[e("pre",ye,i(o.cuerpo_md),1)])]))),128))]),p.value?(n(),a("div",ke,[e("form",{class:"bg-card rounded-2xl border border-border p-6 w-[90vw] max-w-2xl space-y-3 text-xs",onSubmit:J(h,["prevent"])},[e("h2",we,i(m.value?"Editar actualización":"Nueva actualización"),1),e("label",Se,[t[18]||(t[18]=e("span",null,"Título",-1)),l(e("input",{name:"titulo","onUpdate:modelValue":t[4]||(t[4]=o=>r.value.titulo=o),class:"border border-border bg-background text-foreground p-2 rounded",required:""},null,512),[[c,r.value.titulo]]),x(v,{message:b.value.titulo},null,8,["message"])]),e("label",Ce,[t[20]||(t[20]=e("span",null,"Audiencia",-1)),l(e("select",{name:"audience","onUpdate:modelValue":t[5]||(t[5]=o=>r.value.audience=o),class:"border border-border bg-background text-foreground p-2 rounded"},t[19]||(t[19]=[e("option",{value:"TODOS"},"Todos",-1),e("option",{value:"DOCENTES"},"Docentes",-1),e("option",{value:"RESPONSABLES"},"Responsables",-1),e("option",{value:"ADMIN"},"Admin",-1)]),512),[[D,r.value.audience]]),x(v,{message:b.value.audience},null,8,["message"])]),e("div",De,[e("label",Ve,[t[21]||(t[21]=e("span",null,"Inicio",-1)),l(e("input",{name:"starts_at",type:"datetime-local","onUpdate:modelValue":t[6]||(t[6]=o=>r.value.starts_at=o),class:"border border-border bg-background text-foreground p-2 rounded",required:""},null,512),[[c,r.value.starts_at]]),x(v,{message:b.value.starts_at},null,8,["message"])]),e("label",Ae,[t[22]||(t[22]=e("span",null,"Fin",-1)),l(e("input",{name:"ends_at",type:"datetime-local","onUpdate:modelValue":t[7]||(t[7]=o=>r.value.ends_at=o),class:"border border-border bg-background text-foreground p-2 rounded"},null,512),[[c,r.value.ends_at]]),x(v,{message:b.value.ends_at},null,8,["message"])]),e("label",Te,[l(e("input",{name:"pinned",type:"checkbox",class:"border-border","onUpdate:modelValue":t[8]||(t[8]=o=>r.value.pinned=o)},null,512),[[K,r.value.pinned]]),t[23]||(t[23]=e("span",null,"Fijar (pin)",-1))])]),e("label",ze,[t[24]||(t[24]=e("span",null,"Cuerpo (Markdown)",-1)),l(e("textarea",{name:"cuerpo_md",rows:"6","onUpdate:modelValue":t[9]||(t[9]=o=>r.value.cuerpo_md=o),minlength:"10",class:"border border-border bg-background text-foreground p-2 rounded",required:""},null,512),[[c,r.value.cuerpo_md]]),x(v,{message:b.value.cuerpo_md},null,8,["message"])]),e("div",Ee,[e("button",{type:"button",class:"px-3 py-1 rounded border border-border",onClick:t[10]||(t[10]=o=>p.value=!1)}," Cancelar "),t[25]||(t[25]=e("button",{type:"submit",class:"px-4 py-2 rounded bg-primary text-primary-foreground"}," Guardar ",-1))])],32)])):C("",!0)])]),_:1}))}});export{Be as default};

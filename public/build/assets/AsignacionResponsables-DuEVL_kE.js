import{d as z,n as F,c as A,r as b,a as T,o as n,w as W,b as e,e as a,f as i,t as s,g as q,v as G,u as M,W as u,F as f,i as h,k as m,j as R}from"./app-0xfeTETD.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-Czkn1H1y.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BRkfCIi1.js";import"./index-1Zo7FGYr.js";const H={class:"p-8 min-h-screen bg-background text-foreground"},J={class:"flex flex-wrap items-center justify-between gap-4 mb-6"},K={class:"text-sm text-muted-foreground"},O={class:"flex items-center gap-2"},Q={key:0,class:"text-sm text-muted-foreground"},X={key:1,class:"space-y-4"},Y={class:"flex-1"},Z={class:"font-semibold text-base md:text-lg"},ee={class:"text-xs md:text-sm text-muted-foreground mt-1 space-x-2"},te={key:0},oe={class:"text-xs md:text-sm text-muted-foreground mt-1"},se={class:"font-medium"},de={class:"text-xs text-muted-foreground mt-1"},ne={class:"flex flex-row md:flex-col items-center gap-2 mt-3 md:mt-0 md:ml-4"},ae=["onClick"],re={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40"},le={class:"w-full max-w-3xl rounded-xl border border-border bg-card p-6 shadow-xl max-h-[90vh] overflow-y-auto"},ie={class:"flex items-start justify-between mb-4"},ce={class:"text-lg font-semibold mb-1"},ue={class:"grid md:grid-cols-3 gap-4"},me={class:"md:col-span-1 border rounded-lg p-3 bg-muted/40"},pe={key:0},xe={class:"font-medium"},ve={class:"text-xs text-muted-foreground mt-1"},be={class:"text-xs text-muted-foreground"},fe={key:1,class:"text-xs text-muted-foreground"},ge={class:"mt-4 text-xs text-muted-foreground"},_e={class:"md:col-span-2"},ye={key:0,class:"text-xs text-muted-foreground"},he={class:"space-y-2 max-h-72 overflow-y-auto"},ke=["onClick"],we={class:"font-medium"},Ce={class:"text-xs text-muted-foreground"},Se={key:0,class:"text-emerald-600 text-xs font-semibold"},De={class:"mt-6 flex justify-end gap-2"},je=["disabled"],Be=z({__name:"AsignacionResponsables",setup(Ne){const p=F(),k=A(()=>p.props.cursos??[]),P=A(()=>{var d,o;return p.props.currentUserRole??((o=(d=p.props.auth)==null?void 0:d.user)==null?void 0:o.role)}),x=b(p.props.periodo??"2025-2"),g=b(!1),r=b(null),l=b(null);function V(d){r.value=d,l.value=d.docente_id??null,g.value=!0}function _(){g.value=!1,r.value=null,l.value=null}function B(d){l.value=d}function E(){!r.value||!l.value||u.patch(`/cursos/${r.value.id}/docente-responsable`,{docente_id:l.value},{onSuccess:()=>{_(),u.reload({only:["cursos"]})}})}function $(d){return d.docente_id?"Asignado":"Sin asignar"}function I(d){return d.docente_id?"bg-emerald-600 text-white":"bg-gray-300 text-gray-800"}function U(){u.get("/cursos/asignaciones",{periodo:x.value},{preserveState:!0,preserveScroll:!0})}function v(d){return d.modalidadRel??d.modalidad_rel??null}function c(d){return d.docentesParticipantes??d.docentes_participantes??[]}return(d,o)=>(n(),T(L,null,{default:W(()=>{var w;return[e("div",H,[e("div",J,[e("div",null,[o[2]||(o[2]=e("h1",{class:"text-2xl font-bold"}," Asignación de docentes responsables ",-1)),e("p",K," Vista para "+s(P.value==="admin"?"administrador":"docente responsable")+". ",1)]),e("div",O,[o[4]||(o[4]=e("span",{class:"text-sm text-muted-foreground"},"Periodo:",-1)),q(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>x.value=t),onChange:U,class:"border border-border bg-background text-foreground p-2 rounded"},o[3]||(o[3]=[e("option",{value:"2025-2"},"2025-2",-1),e("option",{value:"2026-0"},"2026-0",-1),e("option",{value:"2026-1"},"2026-1",-1)]),544),[[G,x.value]]),e("button",{type:"button",class:"px-3 py-2 rounded border bg-secondary text-secondary-foreground text-xs md:text-sm hover:opacity-90 transition",onClick:o[1]||(o[1]=()=>M(u).post("/cursos/traer",{periodo:x.value},{onSuccess:()=>M(u).reload()}))}," Traer cursos ")])]),k.value.length===0?(n(),a("div",Q," No hay cursos para el periodo seleccionado. ")):(n(),a("div",X,[(n(!0),a(f,null,h(k.value,t=>{var y,C,S,D,j,N;return n(),a("div",{key:t.id,class:"rounded-xl border border-border bg-card shadow-sm flex flex-col md:flex-row md:items-center md:justify-between px-4 py-3"},[e("div",Y,[e("div",Z,s(t.nombre)+" ("+s(t.codigo)+") ",1),e("div",ee,[e("span",null," Modalidad: "+s(((y=v(t))==null?void 0:y.nombre)??t.modalidad),1),(C=v(t))!=null&&C.area?(n(),a("span",te," | Área: "+s((D=(S=v(t))==null?void 0:S.area)==null?void 0:D.nombre),1)):i("",!0),e("span",null,"| Periodo: "+s(t.periodo),1)]),e("div",oe,[o[5]||(o[5]=m(" Responsable actual: ")),e("span",se,[m(s(((j=t.docente)==null?void 0:j.nombre)??"Sin asignar")+" ",1),(N=t.docente)!=null&&N.apellido?(n(),a(f,{key:0},[m(s(" "+t.docente.apellido),1)],64)):i("",!0)])]),e("div",de," Docentes asociados: "+s(c(t).length),1)]),e("div",ne,[e("span",{class:R(["px-3 py-1 rounded-full text-xs font-semibold",I(t)])},s($(t)),3),e("button",{type:"button",class:"px-3 py-1 rounded border bg-primary text-primary-foreground text-xs md:text-sm hover:opacity-90 transition",onClick:Ae=>V(t)}," Asignar / Editar ",8,ae)])])}),128))])),g.value&&r.value?(n(),a("div",re,[e("div",le,[e("div",ie,[e("div",null,[e("h2",ce," Asignar responsable - "+s(r.value.nombre),1),o[6]||(o[6]=e("p",{class:"text-xs text-muted-foreground"}," Seleccione al docente responsable entre los docentes asociados al curso. ",-1))]),e("button",{type:"button",class:"text-muted-foreground hover:text-foreground",onClick:_}," ✕ ")]),e("div",ue,[e("div",me,[o[8]||(o[8]=e("h3",{class:"text-sm font-semibold mb-2"},"Docente seleccionado",-1)),l.value&&c(r.value).length?(n(),a("div",pe,[d.d.id===l.value?(n(!0),a(f,{key:0},h(c(r.value),t=>(n(),a("div",{key:t.id,class:"border rounded-md p-2 bg-emerald-50 text-sm"},[e("div",xe,s(t.nombre)+" "+s(t.apellido),1),e("div",ve," DNI: "+s(t.dni||"—"),1),e("div",be,s(t.email||"Sin correo registrado"),1)]))),128)):i("",!0)])):(n(),a("div",fe," No hay docente seleccionado. ")),e("div",ge,[m(" Periodo: "+s(r.value.periodo),1),o[7]||(o[7]=e("br",null,null,-1)),m(" Modalidad: "+s(((w=v(r.value))==null?void 0:w.nombre)??r.value.modalidad),1)])]),e("div",_e,[o[9]||(o[9]=e("h3",{class:"text-sm font-semibold mb-2"},"Docentes del curso",-1)),c(r.value).length===0?(n(),a("div",ye," Este curso no tiene docentes asociados a través del módulo de asignación múltiple. ")):i("",!0),e("div",he,[(n(!0),a(f,null,h(c(r.value),t=>(n(),a("button",{key:t.id,type:"button",class:R(["w-full text-left border rounded-md px-3 py-2 text-sm flex items-center justify-between",[l.value===t.id?"bg-emerald-50 border-emerald-500":"bg-background hover:bg-muted"]]),onClick:y=>B(t.id)},[e("div",null,[e("div",we,s(t.nombre)+" "+s(t.apellido),1),e("div",Ce," DNI: "+s(t.dni||"—")+" · "+s(t.email||"Sin correo"),1)]),l.value===t.id?(n(),a("div",Se," Seleccionado ")):i("",!0)],10,ke))),128))])])]),e("div",De,[e("button",{type:"button",class:"px-4 py-2 rounded border text-sm",onClick:_}," Cancelar "),e("button",{type:"button",class:"px-4 py-2 rounded bg-primary text-primary-foreground text-sm hover:opacity-90 transition",disabled:!l.value,onClick:E}," Guardar información ",8,je)])])])):i("",!0)])]}),_:1}))}});export{Be as default};

import{d as P,n as T,c as M,r as v,z as O,e as l,o as n,m,u as x,s as z,w,b as o,f as u,l as D,g as i,h as c,t as f,F as W,i as A,v as H,k as C,p as Z,P as $,j as q,W as _}from"./app-0xfeTETD.js";import{_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-Czkn1H1y.js";import{P as J}from"./PdfFileCard-Bynqgh78.js";import{_ as U}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BRkfCIi1.js";import{S as k}from"./sweetalert2.esm.all-ePrzfkxH.js";import"./index-1Zo7FGYr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K={key:0},Q={class:"flex flex-1 flex-col gap-4 rounded-xl p-4"},X={key:0,class:"text-red-500 text-sm"},Y={key:0,class:"text-red-500 text-sm"},ee={key:0,class:"text-red-500 text-sm"},oe={key:0,class:"text-red-500 text-sm"},te={key:0,class:"text-red-500 text-sm"},re={id:"especialidades-list"},se=["value"],le={key:0,class:"text-red-500 text-sm"},ne={key:0,class:"mt-3 flex items-start gap-3"},ae={class:"mt-1 flex gap-2 text-xs text-muted-foreground"},de={key:0,class:"text-red-500 text-sm"},ue={class:"border border-border rounded-md p-3 space-y-2"},ie={class:"font-semibold flex items-center gap-2"},pe={key:0,class:"space-y-2 mt-2"},ce={key:0,class:"text-red-500 text-sm"},fe={key:0,class:"text-red-500 text-sm"},ve={class:"flex gap-4"},me={key:1},Ue=P({__name:"create",setup(be){const j=[{title:"Docentes",href:"/docents"},{title:"Crear Docente",href:"#"}],B=T(),I=M(()=>B.props.especialidades??[]),r=v({nombre:"",apellido:"",dni:"",email:"",telefono:"",especialidad:"",cv_sunedu:null,linkedin:"",estado:"activo",cip:"",crear_usuario:!1,user_password:"",user_password_confirmation:""}),s=v({}),p=v(null),V=v(null),y=v(!1),L=v(""),S=v("success"),E=(d,e="success")=>{L.value=d,S.value=e,y.value=!0,setTimeout(()=>{y.value=!1},2500)},N=(d,e)=>{var t;const a=d.target;if(a.files&&a.files.length>0){const b=a.files[0];if(b.type!=="application/pdf"){s.value[e]=["El archivo debe ser un PDF."];return}r.value[e]=b;const g=URL.createObjectURL(b);(t=p.value)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(p.value),p.value=g,E("CV Sunedu listo para guardar.","success")}},R=d=>{var e;(e=p.value)!=null&&e.startsWith("blob:")&&URL.revokeObjectURL(p.value),p.value=null,r.value.cv_sunedu=null,delete s.value.cv_sunedu,E("CV Sunedu eliminado del formulario.","success")},h=()=>{if(r.value.crear_usuario){const e=r.value.user_password??"",a=r.value.user_password_confirmation??"";if(delete s.value.user_password,delete s.value.user_password_confirmation,!e){s.value.user_password=["La La contrase?a es obligatoria."],k.fire({icon:"error",title:"Corrige los errores",text:"Ingresa una contrase?a v?lida."});return}if(e!==a){s.value.user_password_confirmation=["Las contrase?as no coinciden."],k.fire({icon:"error",title:"Corrige los errores",text:"La confirmaci?n de contrase?a no coincide."});return}}const d=new FormData;Object.entries(r.value).forEach(([e,a])=>{if(e==="crear_usuario"){d.append(e,a?"1":"0");return}a!==null&&d.append(e,a)}),console.log(r.value),_.post("/docents",d,{forceFormData:!0,onSuccess:()=>{s.value={},k.fire({icon:"success",title:"Docente creado",text:"El docente ha sido creado exitosamente."}).then(()=>{_.visit("/docents")})},onError:e=>{const a=Object.fromEntries(Object.entries(e).map(([b,g])=>[b,Array.isArray(g)?g:[String(g)]]));s.value=a;const t=Object.values(a).flat()[0];k.fire({icon:"error",title:"Corrige los errores",text:t??"Revisa los campos marcados e intentalo nuevamente."})}})},F=()=>{k.fire({title:"?Est?s seguro?",text:"Los cambios no guardados se perderan.",icon:"warning",showCancelButton:!0,confirmButtonText:"S?, cancelar",cancelButtonText:"No"}).then(d=>{d.isConfirmed&&_.visit("/docents")})};return O(()=>{var d;(d=p.value)!=null&&d.startsWith("blob:")&&URL.revokeObjectURL(p.value)}),(d,e)=>r.value?(n(),l("div",K,[m(x(z),{title:"Crear Docente"}),m(G,{breadcrumbs:j},{default:w(()=>{var a;return[o("div",Q,[e[35]||(e[35]=o("h1",{class:"text-2xl font-bold"},"Crear Docente",-1)),o("form",{onSubmit:D(h,["prevent"]),class:"space-y-6 max-w-lg bg-card text-foreground p-6 rounded-xl shadow-sm border border-border"},[o("div",null,[e[15]||(e[15]=o("label",{class:"font-semibold"},"Nombre",-1)),i(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value.nombre=t),type:"text",placeholder:"Nombre",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.nombre]]),s.value.nombre?(n(),l("p",X,f(s.value.nombre[0]),1)):u("",!0)]),o("div",null,[e[16]||(e[16]=o("label",{class:"font-semibold"},"Apellido",-1)),i(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.apellido=t),type:"text",placeholder:"Apellido",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.apellido]]),s.value.apellido?(n(),l("p",Y,f(s.value.apellido[0]),1)):u("",!0)]),o("div",null,[e[17]||(e[17]=o("label",{class:"font-semibold"},"DNI",-1)),i(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.dni=t),type:"text",placeholder:"DNI",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.dni]]),s.value.dni?(n(),l("p",ee,f(s.value.dni[0]),1)):u("",!0)]),o("div",null,[e[18]||(e[18]=o("label",{class:"font-semibold"},"Email",-1)),i(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.email=t),type:"email",placeholder:"Email",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.email]]),s.value.email?(n(),l("p",oe,f(s.value.email[0]),1)):u("",!0)]),o("div",null,[e[19]||(e[19]=o("label",{class:"font-semibold"},"Telefono",-1)),i(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.telefono=t),type:"text",placeholder:"Telefono",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.telefono]]),s.value.telefono?(n(),l("p",te,f(s.value.telefono[0]),1)):u("",!0)]),o("div",null,[e[20]||(e[20]=o("label",{class:"font-semibold"},"Especialidad",-1)),i(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.especialidad=t),list:"especialidades-list",type:"text",placeholder:"Especialidad",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.especialidad]]),o("datalist",re,[(n(!0),l(W,null,A(I.value,t=>(n(),l("option",{key:t.id,value:t.nombre},null,8,se))),128))]),e[21]||(e[21]=o("p",{class:"text-xs text-muted-foreground mt-1"}," Si no existe, escribe una nueva y se agregara al catalogo. ",-1)),s.value.especialidad?(n(),l("p",le,f(s.value.especialidad[0]),1)):u("",!0)]),o("div",null,[e[24]||(e[24]=o("label",{class:"font-semibold"},"CV Sunedu (PDF)",-1)),o("input",{ref_key:"cvSuneduInput",ref:V,type:"file",accept:"application/pdf",onChange:e[6]||(e[6]=t=>N(t,"cv_sunedu"))},null,544),p.value?(n(),l("div",ne,[m(J,{url:p.value,name:((a=r.value.cv_sunedu)==null?void 0:a.name)??"cv_sunedu.pdf"},null,8,["url","name"]),o("div",ae,[m(x(U),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8",title:"Cambiar archivo",onClick:e[7]||(e[7]=()=>{var t;return(t=V.value)==null?void 0:t.click()})},{default:w(()=>e[22]||(e[22]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[o("path",{d:"M4 20h4l10.5-10.5-4-4L4 16v4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1}),m(x(U),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8 text-red-600",title:"Eliminar archivo",onClick:e[8]||(e[8]=()=>R("cv_sunedu"))},{default:w(()=>e[23]||(e[23]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[o("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"}),o("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14V4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1})])])):u("",!0)]),o("div",null,[e[25]||(e[25]=o("label",{class:"font-semibold"},"LinkedIn",-1)),i(o("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>r.value.linkedin=t),type:"text",placeholder:"LinkedIn",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.linkedin]])]),o("div",null,[e[27]||(e[27]=o("label",{class:"font-semibold"},"Estado CIP",-1)),i(o("select",{"onUpdate:modelValue":e[10]||(e[10]=t=>r.value.estado=t),class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},e[26]||(e[26]=[o("option",{value:"activo"},"Habilitado",-1),o("option",{value:"inactivo"},"No habilitado",-1)]),512),[[H,r.value.estado]]),s.value.estado?(n(),l("p",de,f(s.value.estado[0]),1)):u("",!0)]),o("div",null,[e[28]||(e[28]=o("label",{class:"font-semibold"},"CIP",-1)),i(o("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>r.value.cip=t),type:"text",placeholder:"CIP",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.cip]])]),o("div",ue,[o("label",ie,[i(o("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=t=>r.value.crear_usuario=t),class:"rounded border-border text-primary focus:ring-ring"},null,512),[[Z,r.value.crear_usuario]]),e[29]||(e[29]=C(" Crear cuenta de acceso para este docente "))]),e[32]||(e[32]=o("p",{class:"text-xs text-muted-foreground"}," Si se activa, se creará un usuario con el email del docente y la contraseña indicada a continuación. ",-1)),r.value.crear_usuario?(n(),l("div",pe,[o("div",null,[e[30]||(e[30]=o("label",{class:"font-semibold text-sm"},"Contraseña inicial",-1)),i(o("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>r.value.user_password=t),type:"password",placeholder:"Contraseña para el docente",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.user_password]]),s.value.user_password?(n(),l("p",ce,f(s.value.user_password[0]),1)):u("",!0)]),o("div",null,[e[31]||(e[31]=o("label",{class:"font-semibold text-sm"},"Confirmar contraseña",-1)),i(o("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>r.value.user_password_confirmation=t),type:"password",placeholder:"Repetir contraseña",class:"w-full rounded-md border border-border bg-background text-foreground p-2 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[c,r.value.user_password_confirmation]]),s.value.user_password_confirmation?(n(),l("p",fe,f(s.value.user_password_confirmation[0]),1)):u("",!0)])])):u("",!0)]),o("div",ve,[m(x(U),{type:"submit",class:"bg-purple-500 text-white px-4 py-2 rounded-md hover:bg-purple-600"},{default:w(()=>e[33]||(e[33]=[C(" Crear Docente ")])),_:1}),m(x($),{href:"/docents",class:"bg-destructive text-destructive-foreground px-4 py-2 rounded-md hover:opacity-90",onClick:D(F,["prevent"])},{default:w(()=>e[34]||(e[34]=[C(" Cancelar ")])),_:1})])],32)]),y.value?(n(),l("div",{key:0,class:q(["fixed bottom-4 right-4 px-4 py-2 rounded shadow text-sm",S.value==="success"?"bg-green-600 text-white":"bg-red-600 text-white"])},f(L.value),3)):u("",!0)]}),_:1})])):(n(),l("div",me,e[36]||(e[36]=[o("p",null,"Cargando...",-1)])))}});export{Ue as default};

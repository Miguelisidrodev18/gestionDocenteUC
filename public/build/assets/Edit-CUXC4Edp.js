import{d as X,r as a,z as Y,e as i,o as u,m as d,u as m,s as _,w as b,b as t,f as v,l as ee,g,h as w,t as D,F as P,i as te,a as le,v as oe,k as ne,j as re,W as U}from"./app-0xfeTETD.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-Czkn1H1y.js";import{_ as C}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BRkfCIi1.js";import{P as F}from"./PdfFileCard-Bynqgh78.js";import"./index-1Zo7FGYr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"flex flex-1 flex-col gap-4 rounded-xl p-4 text-foreground"},ae={key:0,class:"text-red-500 text-sm"},ie={key:0,class:"text-red-500 text-sm"},de={key:0,class:"text-red-500 text-sm"},ce={id:"especialidades-list"},pe=["value"],ve={class:"rounded-md border border-border bg-card/80 p-4 space-y-4"},fe={class:"mb-6 border rounded-md p-4 bg-card text-foreground"},me={class:"mb-4 flex items-center gap-2"},be={class:"mb-4"},ge={key:0,class:"text-xs text-red-500 mt-1"},xe={key:1,class:"mt-2 flex gap-2"},ke={key:2,class:"text-xs text-muted-foreground"},we={class:"flex items-center gap-2"},Ce={key:0,class:"mt-3"},ye={class:"mt-2 flex gap-2"},Ue={key:0,class:"text-[11px] text-red-500 mt-1"},Ve={class:"flex items-center gap-2"},he={key:0,class:"mt-3"},Le={class:"mt-2 flex gap-2"},De={key:0,class:"text-[11px] text-red-500 mt-1"},Be=X({__name:"Edit",props:{docent:{},especialidades:{}},setup(T){const A=[{title:"Docentes",href:"/docents"},{title:"Editar Docente",href:"#"}],r=T,o=a({nombre:r.docent.nombre??"",apellido:r.docent.apellido??"",dni:r.docent.dni??"",email:r.docent.email??"",telefono:r.docent.telefono??"",especialidad:r.docent.especialidad??"",cv_sunedu:null,cul:null,linkedin:r.docent.linkedin??"",estado:r.docent.estado??"activo",cip:r.docent.cip??""}),c=a(r.docent.cv_sunedu?`/storage/${r.docent.cv_sunedu}`:null),p=a(r.docent.cul?`/storage/${r.docent.cul}`:null),M=a(null),B=a(null),E=a(!1),j=a(!1),I=a(null),S=a(null),y=a(null),R=a(!1),z=a(""),O=a("success"),x=(l,e="success")=>{z.value=l,O.value=e,R.value=!0,setTimeout(()=>{R.value=!1},2500)},N=(l,e)=>{var f,V;const s=l.target;if(s.files&&s.files.length>0){const h=s.files[0];o.value[e]=h;const L=URL.createObjectURL(h);e==="cv_sunedu"?(E.value=!1,(f=c.value)!=null&&f.startsWith("blob:")&&URL.revokeObjectURL(c.value),c.value=L,x("CV Sunedu listo para guardar.","success")):e==="cul"&&(j.value=!1,(V=p.value)!=null&&V.startsWith("blob:")&&URL.revokeObjectURL(p.value),p.value=L,x("CUL listo para guardar.","success"))}},k=a({}),G=l=>{const e=l.target;e.files&&e.files.length>0&&(S.value=e.files[0],y.value=null,q())},q=()=>{if(!S.value){y.value="Selecciona un archivo primero.";return}const l=new FormData;l.append("cv",S.value),U.post(`/docentes/${r.docent.id}/cv/upload`,l,{forceFormData:!0,onSuccess:()=>{y.value=null,S.value=null,x("CV subido correctamente.","success"),U.reload()},onError:()=>{y.value="Error al subir el CV.",x("Error al subir el CV.","error")}})},J=()=>{var l;(l=I.value)==null||l.click()},K=()=>{confirm("¿Deseas eliminar el CV Docente?")&&U.delete(`/docentes/${r.docent.id}/cv/delete`,{onSuccess:()=>{x("CV Docente eliminado.","success"),U.reload()},onError:()=>{x("Error al eliminar el CV Docente.","error")}})},Z=l=>{var e,s;l==="cv_sunedu"?(e=M.value)==null||e.click():(s=B.value)==null||s.click()},W=l=>{var e,s;l==="cv_sunedu"?((e=c.value)!=null&&e.startsWith("blob:")&&URL.revokeObjectURL(c.value),c.value=null,o.value.cv_sunedu=null,E.value=!0,x("CV Sunedu se eliminara al guardar cambios.","success")):((s=p.value)!=null&&s.startsWith("blob:")&&URL.revokeObjectURL(p.value),p.value=null,o.value.cul=null,j.value=!0,x("CUL se eliminara al guardar cambios.","success"))},Q=()=>{const l=new FormData;Object.entries(o.value).forEach(([e,s])=>{s!==null&&l.append(e,s)}),l.append("cv_sunedu_delete",E.value?"1":"0"),l.append("cul_delete",j.value?"1":"0"),l.append("_method","put"),U.post(`/docents/${r.docent.id}`,l,{forceFormData:!0,onSuccess:()=>{k.value={},U.visit("/docents",{replace:!0})},onError:e=>{k.value=Object.fromEntries(Object.entries(e).map(([s,f])=>[s,Array.isArray(f)?f:[String(f)]]))}})};return Y(()=>{var l,e;(l=c.value)!=null&&l.startsWith("blob:")&&URL.revokeObjectURL(c.value),(e=p.value)!=null&&e.startsWith("blob:")&&URL.revokeObjectURL(p.value)}),(l,e)=>(u(),i(P,null,[d(m(_),{title:"Editar Docente"}),d(se,{breadcrumbs:A},{default:b(()=>{var s,f,V,h,L,$,H;return[t("div",ue,[e[43]||(e[43]=t("h1",{class:"text-2xl font-bold"},"Editar Docente",-1)),t("form",{onSubmit:ee(Q,["prevent"]),class:"space-y-6 max-w-lg"},[t("div",null,[e[15]||(e[15]=t("label",null,"Nombre",-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.nombre=n),type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.nombre]]),k.value.nombre?(u(),i("p",ae,D((s=k.value.nombre)==null?void 0:s[0]),1)):v("",!0)]),t("div",null,[e[16]||(e[16]=t("label",null,"Apellido",-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.apellido=n),type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.apellido]]),k.value.apellido?(u(),i("p",ie,D((f=k.value.apellido)==null?void 0:f[0]),1)):v("",!0)]),t("div",null,[e[17]||(e[17]=t("label",null,"DNI",-1)),g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.dni=n),type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.dni]]),k.value.dni?(u(),i("p",de,D((V=k.value.dni)==null?void 0:V[0]),1)):v("",!0)]),t("div",null,[e[18]||(e[18]=t("label",null,"Email",-1)),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.email=n),type:"email",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.email]])]),t("div",null,[e[19]||(e[19]=t("label",null,"Teléfono",-1)),g(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.telefono=n),type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.telefono]])]),t("div",null,[e[20]||(e[20]=t("label",null,"Especialidad",-1)),g(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.especialidad=n),list:"especialidades-list",type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.especialidad]]),t("datalist",ce,[(u(!0),i(P,null,te(r.especialidades??[],n=>(u(),i("option",{key:n.id,value:n.nombre},null,8,pe))),128))]),e[21]||(e[21]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Si no existe, escribe una nueva y se agregara al catalogo. ",-1))]),t("div",ve,[e[37]||(e[37]=t("div",null,[t("h2",{class:"text-sm font-semibold"},"Documentos"),t("p",{class:"text-xs text-muted-foreground"},"Gestiona CV Docente, CV Sunedu y CUL.")],-1)),t("div",fe,[e[29]||(e[29]=t("h2",{class:"font-semibold mb-2 text-sm"},"CV Docente",-1)),e[30]||(e[30]=t("p",{class:"text-xs text-muted-foreground mb-3"}," 1. Descarga la plantilla vacia. 2. Completa el archivo y vuelve a subirlo firmado o actualizado. ",-1)),t("div",me,[d(m(C),{asChild:"",variant:"outline"},{default:b(()=>e[22]||(e[22]=[t("a",{href:"/docentes/cv/plantilla",target:"_blank",rel:"noopener noreferrer"}," Descargar plantilla vacia ",-1)])),_:1}),e[23]||(e[23]=t("span",{class:"text-xs text-muted-foreground"},"Luego selecciona el archivo para subirlo.",-1))]),t("div",be,[e[24]||(e[24]=t("h3",{class:"font-medium mb-2 text-xs"},"Subir CV firmado / actualizado",-1)),t("input",{ref_key:"cvUploadInput",ref:I,type:"file",accept:".doc,.docx,.pdf",onChange:G,class:"text-sm"},null,544),e[25]||(e[25]=t("p",{class:"text-xs text-muted-foreground mt-1"},"La subida es automatica al seleccionar el archivo.",-1)),y.value?(u(),i("p",ge,D(y.value),1)):v("",!0)]),t("div",null,[e[28]||(e[28]=t("h3",{class:"font-medium mb-2 text-xs"},"CV Docente (PDF)",-1)),r.docent.cv_docente?(u(),le(F,{key:0,url:`/storage/${r.docent.cv_docente}`,name:"cv_docente.pdf"},null,8,["url"])):v("",!0),r.docent.cv_docente?(u(),i("div",xe,[d(m(C),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8",title:"Cambiar archivo",onClick:J},{default:b(()=>e[26]||(e[26]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[t("path",{d:"M4 20h4l10.5-10.5-4-4L4 16v4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1}),d(m(C),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8 text-red-600",title:"Eliminar archivo",onClick:K},{default:b(()=>e[27]||(e[27]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[t("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14V4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1})])):(u(),i("p",ke,"No disponible"))])]),t("div",null,[e[33]||(e[33]=t("label",null,"CV Sunedu (PDF)",-1)),t("div",we,[t("input",{ref_key:"cvSuneduInput",ref:M,type:"file",accept:"application/pdf",onChange:e[6]||(e[6]=n=>N(n,"cv_sunedu"))},null,544)]),c.value?(u(),i("div",Ce,[d(F,{url:c.value,name:((h=o.value.cv_sunedu)==null?void 0:h.name)??((L=r.docent.cv_sunedu)==null?void 0:L.split("/").pop())??"cv_sunedu.pdf"},null,8,["url","name"]),t("div",ye,[d(m(C),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8",title:"Cambiar archivo",onClick:e[7]||(e[7]=()=>Z("cv_sunedu"))},{default:b(()=>e[31]||(e[31]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[t("path",{d:"M4 20h4l10.5-10.5-4-4L4 16v4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1}),d(m(C),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8 text-red-600",title:"Eliminar archivo",onClick:e[8]||(e[8]=()=>W("cv_sunedu"))},{default:b(()=>e[32]||(e[32]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[t("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14V4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1})]),E.value?(u(),i("p",Ue," El CV Sunedu se eliminará al guardar los cambios. ")):v("",!0)])):v("",!0)]),t("div",null,[e[36]||(e[36]=t("label",null,"Certificado Único Laboral (CUL)",-1)),t("div",Ve,[t("input",{ref_key:"culInput",ref:B,type:"file",accept:"application/pdf",onChange:e[9]||(e[9]=n=>N(n,"cul"))},null,544)]),p.value?(u(),i("div",he,[d(F,{url:p.value,name:(($=o.value.cul)==null?void 0:$.name)??((H=r.docent.cul)==null?void 0:H.split("/").pop())??"cul.pdf"},null,8,["url","name"]),t("div",Le,[d(m(C),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8",title:"Cambiar archivo",onClick:e[10]||(e[10]=()=>Z("cul"))},{default:b(()=>e[34]||(e[34]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[t("path",{d:"M4 20h4l10.5-10.5-4-4L4 16v4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1}),d(m(C),{type:"button",variant:"outline",size:"icon",class:"h-8 w-8 text-red-600",title:"Eliminar archivo",onClick:e[11]||(e[11]=()=>W("cul"))},{default:b(()=>e[35]||(e[35]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"w-4 h-4"},[t("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14V4Z",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1})]),j.value?(u(),i("p",De," El CUL se eliminar� al guardar los cambios. ")):v("",!0)])):v("",!0)])]),t("div",null,[e[38]||(e[38]=t("label",null,"LinkedIn",-1)),g(t("input",{"onUpdate:modelValue":e[12]||(e[12]=n=>o.value.linkedin=n),type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.linkedin]])]),t("div",null,[e[40]||(e[40]=t("label",null,"Estado CIP",-1)),g(t("select",{"onUpdate:modelValue":e[13]||(e[13]=n=>o.value.estado=n),class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},e[39]||(e[39]=[t("option",{value:"activo"},"Habilitado",-1),t("option",{value:"inactivo"},"No habilitado",-1)]),512),[[oe,o.value.estado]])]),t("div",null,[e[41]||(e[41]=t("label",null,"N° CIP",-1)),g(t("input",{"onUpdate:modelValue":e[14]||(e[14]=n=>o.value.cip=n),type:"text",class:"w-full rounded-md border border-border bg-background text-foreground px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[w,o.value.cip]])]),d(m(C),{type:"submit",class:"bg-primary text-primary-foreground"},{default:b(()=>e[42]||(e[42]=[ne(" Guardar ")])),_:1})],32)]),R.value?(u(),i("div",{key:0,class:re(["fixed bottom-4 right-4 px-4 py-2 rounded shadow text-sm",O.value==="success"?"bg-green-600 text-white":"bg-red-600 text-white"])},D(z.value),3)):v("",!0)]}),_:1})],64))}});export{Be as default};
